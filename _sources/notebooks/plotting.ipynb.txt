{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Plotting"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Import the modules and set the matplotlib style\n",
    "import hep_spt\n",
    "hep_spt.set_style()\n",
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "from scipy.stats import norm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plotting a (non)weighted sample\n",
    "Use the function \"errorbar_hist\" to plot the same sample without and with weights. In the non-weighted case, the errors are considered poissonian, so one can see asymmetric error bars for low values of the number of entries."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<matplotlib.figure.Figure at 0x7fdfe743e050>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create a random sample\n",
    "size = 200\n",
    "smp  = np.random.normal(0, 3, size)\n",
    "wgts = np.random.uniform(0, 1, size)\n",
    "\n",
    "fig, (ax0, ax1) = plt.subplots(1, 2, figsize=(10, 5))\n",
    "\n",
    "# Make the non-weighted plot\n",
    "values, edges, ex, ey = hep_spt.errorbar_hist(smp, bins=10, rg=(-7, 7))\n",
    "centers = (edges[1:] + edges[:-1])/2.\n",
    "\n",
    "ax0.errorbar(centers, values, ey, ex, ls='none')\n",
    "ax0.set_title('Non-weighted sample')\n",
    "\n",
    "# Make the weighted plot\n",
    "values, edges, ex, ey = hep_spt.errorbar_hist(smp, bins=10, rg=(-7, 7), wgts=wgts)\n",
    "centers = (edges[1:] + edges[:-1])/2.\n",
    "\n",
    "ax1.errorbar(centers, values, ey, ex, ls='none')\n",
    "ax1.set_title('Weighted sample');"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Calculating the pull of a distribution\n",
    "Sometimes we want to calculate the distance in terms of standard deviations from a curve to our measurements. This example creates a random sample of events following a normal distribution and overlies it with the original curve. The pull plot is shown below."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAZ8AAAEECAYAAAD3QzkUAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMS4yLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvNQv5yAAAIABJREFUeJzt3Xt8VPWd+P/XJ4QQCJAQqoAiGQbFeiUGqPa36gwS2m5ba1e5aOt2tSrRatWfVqL1ksTtrg1eilutG2pba2+LonZrLbtLaBN3tSgQgra1KkSiFKyUkECAQEg+3z/OmXAymcs5M2fmzEzez8djHjDnMvOZk3PO+3zuSmuNEEIIkU55XidACCHE8CPBRwghRNpJ8BFCCJF2EnyEEEKknQQfIYQQaSfBRwghRNpJ8BFCCJF2EnyEEEKknQQfIYQQaSfBJ4xSaoVSaoXX6RBCiFyW73UCMlB5IBAIALd4nRAhhMgyyu6GkvMRQgiRdhJ8hBBCpJ0EHyGEEGknwUcIIUTaSYMDIYSw6O3tZceOHfT09HidlIxVWFjI1KlTGTlyZMKfIcFHiAzm8/lob28HoKamhtraWm8TNAzs2LGDcePG4fP5UMp2461hQ2vNnj172LFjB9OnT0/4cyT4CJHBfD4fPp+PpqYmr5MybPT09GR84Fm9ejUdHR2UlpaycOHCtH63UoqJEyeye/fupD5Hgo8QQoTJ5MADsGrVKp599lk6Ozs9+X43jo80OBBCiCxVUlLidRISlvE5H6VUCVCvta4KW14BzAHaAD/QprVudLqNEEJkktWrV9PQ0EBVVRVtbW0sXbqUlStXUlFRQVtbG3PmzKGtrY3Vq1dTWVk5aF1paWnMff1+P/X19VRXV9PS0kJlZSUVFRUALF++fGC7xYsXD9pv6dKlrv/OjA8+QD1Qal2glPJjBKQFlmXPKqXatNZtdrcRQohYbr0VWlvd/czyclgRY/TIhQsXUl1dzcKFC+ns7OSBBx5gwYIFVFZWUl1dzdKlS/H7/QPbha+Lt291dTWVlZX4/X4aGhqoqKhg5cqV+P1+KisrWb58+ZD9UiGjg48ZQEojrKoCGsKWNWAEqkUOthEio4QaGIS0mne+YDA4sCwYDEqrtxwXyo2UlJTQ1tZGZ2cnLS0tTJw4cdB2kdbF27e0dOgtddOmTVRVGYVLy5YtY9GiRVG/0y0ZHXyASmAtsCBs+UKGBpaN5rZOthEio7S3tw8KPpHU1dVJ8EmTWDmUdJk7dy5+v5+Kigr8fr/tdXbWh8yYMYO2tjYqKiro7Oy0vV8yMjb4KKUqgWeAxWHLSzDqbzqsy7XWnUqpUG6pI942UvQmMpW1WXUox2NdZm1pJP2Ack9jYyMtLS20tLRQUVHBsmXLWL58OR0dxu2stLSUlpYWGhsbh6wDYu4LRm4ptH9LSwudnZ0sW7ZsUPFa+H6VlZXu/1CtdUa+gIXmv0uBZy3L/UayI+6jMXJLcbeJ8b1NgUBAC+GFmpqaQe8DgYAOPx+t20RaL5Lzpz/9yeskZIUox8n2PT4jcz5KqYVa69VRVttpW+i4/aFSqsn8b7nTfYVwS3jOpbe3mK6uM6ithb/8Bbq6oKCglttug5kzobvbT1HRe56kVYhkZFzwMYvVvOk5JUQG6O2F//gPePppePXV54ERvPUWTJoE48cb63ftgkOHAH5IQcHfuPNOuPZaOPlkjxMvhE2Z2Ml0sbbRF8cMUklvE6K1Dmqtg4DLDSuFsKevDxoajADyla/Ae+/BtGk/p7z8Jrq7YedO+POfYds2OHDAWH/qqQ8wbtzbPPQQnHoqXHUVbN/u9S8RIr6MCj5mp9CNcTYLNRQI7/tTYllvZxshUio0PphSKm5DgJYWOPdcuP56OPFEeOklePdduPrqbbS2Ps6YMcc+w+fzMW9ekKuuCvLhh/UcPfo55s69jBNOWMXTTx/h5JOPsnw5HD3qfjqFcEumFbvNAWYopZZYllUAfqVUPbBBa71aKdXG0HqdUqBTH+tkGncbIVIp3qCgRku194HbyMur5/jjR/CLX8CSJRBq0FZbWzskIERqjj1q1B5mzHiCqVNXs379FVRXX8rzz8OqVVBWllw6hUiFjAo+WuuV4cuUUsuAuVprazfbRoxA1WJZVmEud7KNEJ456aTT6O7+GXv2/B1f/CI8+SRMmGBv31CgiNYU+xe/0FRVwezZRv1RKlrKimOkybtzGVXsFkWk7rXVDB2loMpc7mQbITzx4YfQ2rqCPXvO49/+DVavth94ampq4q6//HLYsAEmT4bPfAZ+/GMXEi2i8vl8BAIBtNauBp7q6mqWL1/u2udlkowNPkopv1KqAaOfz0KlVINZJ4TWuhOoVkrVK6UWmrmjemtxmp1thPDCtm3wyU/CwYPTOPPMb/L1rx8rZrMj3s0ttH7mTFi/Hi66yGiI8MgjCSdZeGTJkiVxt1m9OlqvlMyWUcVuVmaQqDJfkda3MLhILaFthHCTdWy2SOOylZd/kRdeuJUDB6C8/FbGjXs7pek580wf7e27gJ9w++2L6emBlStl/Lhc0dnZydq1a9M+oZwbMjb4CJGNYo3N1tNzPI8+egn5+fuYNes2tm41nlhTedMPBcN16xZz1VVw990AF+PzvRlzPxk/LjY7A8CG3idyHEPTG7S0DH52Ds1gCrB06VI2btzIxo0bWb169UAACt8mU2VssZsQ2aqpqYmmpibKy8spLy+nqamJF15oYt++Z4AJnH32HYwduzXivnV1dY6+KxgM0tzcHLeZ9IgR8KMfwRe/CPBdvvrVpojpDL1EbKHGBfE4/XsCA/PoVFZWDhpTraWlZWBunYYGY8zkysrKQVNpR9omU0nORwgXRWoMcOQIXHYZbN0KcAmbNjUD8QcNtSNSU+xo8vONlm+nn76Na66ZwbRpEPagPiBeowYRfwBYSGy66U2bNjFnzpwhyysqKujo6KCxsTHitAh2t8kUkvMRwkXhgUBruO46+N3v4Ic/hJqaeTH3T/VNf9QoaGmZwSmnWAPiUFLkFpvdv1Mif8/Zs2cPGoU6ZOXKlbS1tQ3khtrajLZToam0W1paom6TiSTnI0QK7dixhJdfhtpauPJKgNqY27tx04/X6CEYDPLii7Wcey5cfDFMnDiW/PzupL93OLH7d0rk77l06dKB5tUtLS2sXbt2YPbS0FQIofogv9+P3+8fmFK7o6Mj4jaZSGljGgFhUko1BQKBgJR7i2SVl9/Cli2PcNllI3j22aHNqaMV1SRLKUUgEACOBZ/y8mODtTc3N6O15uWXjc6n48f/H2eccQ/Nze6mI1u99dZbnHbaaY72SdXfMpNFOU62yxml2E2IFNi1C7Zu/RdgK889N566utq0fr+dxgQXXggPPgh79pzPyy9XyNhuSbDb8EMcI8FHCJcdPQqXXw5aj+XNN09F630Rb0ipumHZGQEh5Oab4dJLIT//EV591d3e+cNJbW3twCRpcgztkWK3MFLsJpL1rW/Bvfca8/H84z96mxY7xUGdnVBRYQTNLVvsD/OTqxIpdhuOpNhNiAzy+utG44IrrvA+8NhVUgLPPGMUFd54o9epyQzyUB6bG8dHgo8QLjlwwGjRdsIJ8PjjXqfGmTlz4L774Be/MKZhGM4KCwvZs2ePBKAotNbs2bOHwsLCpD5HmloL4ZLbbzf6zaxblzlFV8FgkLq6OpRScYf6v+suYxK7G26A8883JrUbjqZOncqOHTvYvXu310nJWIWFhUydOjWpz5A6nzBS5yMSsXYtfOpT8I1vGC3IstU770B5udESbs0ao3m4zFUjHLBd5yM5HyGSdOAALF1qTGFw//1epyY5M2cawfOmm+Cpp+Dqq2WmU5EaUucjRJLuuQe2bzdmIh092uvUJO+GG+CCC4xixA8/9Do1IldJ8BEiCevXw6OPHrth54K8PFi50sjR3XKL16kRuUqK3YRI0JEjcO21RsX8t7/tdWrc9ZnP+DjhhHt55plrGDNmCiNHrpHJ5oSrJOcjRAJ8Ph+jRt3HH/8IF1zwM8aP9zpF7mpvb+ekk35BUVEbhw49hNbjBq1PZJ4aIawk5yNEAiZN+v94//17WLIEfv7zL3udnJR4+eVGXnsNzjuvn3HjVtDUdNnAukTmqRHCSnI+QjikNWzd+nXy8o7y8MNepyY1QuO/nXsunHDCr/jLX77Ili1D1wuRKAk+Qjj04ovQ0fFJysp+xAkneJ2a1LDW5/h8PyA/v5sbbzQCb/h6IRIhwUcIBw4eNEaCHjPmPU488Xmvk5MWI0fux+9v4JVX4Cc/8To1Ilc4qvNRSo0HSoEOrfU+c9m1wAxgg9Z6eFyNYljy+XxoXcf77/8TRUU38cYbmwa1AIPcbQU2efIaJkxYxrJlcMklUFzsdYpEtnOa81kOVAOVAEqpVcAi4BmgSyl1qbvJEyJztLfn88EHV3D88WvJz38l4ja52AosGAzy8stNvPbabP76V41U9wg3OBrbTSl1mdb6OfP/04GtwARLLmhgfbaSsd1EJFpDXt5vGDfus7z9NlxxRRAYOk+OUiqnR0P+2tegoQE2b4azz/Y6NSIDpWw+n72W/1cCm0OBx5S7V50Y1tasAfgsdXUwZUr07XK9Fdi3vmWM2H3LLccaHwiRiGQaHCwE/iNsmTT+Fzmnt9cY52zmTGPAzVhysb7HqrTUGDy1qQn+8z+9To3IZk6DzwSl1EVKqTuAucBKMIrglFJPANvcTqAQXlu5Ev78Z2O055EjvU6N95YuhdNPN6aPOHzY69SIbOUo+Jj1OQqj+G261nqfUuocoAroAua4n0QhvNPZCTU1MG8eXHzxseXBYJDm5maUUjmf2wmXnw/f+Q5s2wbf/a7XqRHZyvFkckopH3A9sFVr/aS5bD5GU+t9MXbNCtLgQFjdcQc8/DC0tBiTrIljPv95+N//hXffheOP9zo1IkOkpsGBmctpNN+WhJZrrdcBc83AJERO2LbNmC7h6qsl8ETy0ENGp9v77vM6JSIbOa3zWay1PllrfSfwnnWFGYAqXEuZEB7y+XycfPJqenu7KSnJ0QHckvTxj8ONN0JDQx9KnT0siyBF4pyOar3R8v9I5XWlSaRFiIxRUnIx7e0Luf9+uPfe271OTsa67z54/PFuxo79ER0ds5HBroVdTnM+1oAT6TQ7OYm0CJER+vuhre1GRo36iNsl7sRUWgo+31N0ds7m17/2OjUimzgNPsocyw0sgUgpVa6U+m/gf1xLmRAe+dnPYP/+jzN9+vcZM8br1GS+KVN+xZgx27n9dmN2VyHscFTsprV+Til1h1KqA9BKqXqOFbVVa61/63oKhUgTn8/HSSedyuuv/5QRIz5g586HCAbXDqzP1UFDE+Hz+fD5fAC88UYr8A3efXc1p5/+GFOnrgbkeInYHI9woLV+EJgOLMYYaHQx4A81uxYiW7W3t7Njx2KOHDmOwsK7UWpwtWYuDhqaqPb29kHv8/MbmTDhddrbv0JvrzHlthwvEUtC02hrrbuAdeZrgFLKp7Xe7kK6hPDAFD766Bouuwz+9rdDQPmggUNl6ujBQscmNK3EY499glmzYO7cF1mxQo6XiM3tyeTqXf48IdKmvPwljh6F+ihnca4PGupEpGNx5plw3XXw+OPw9ttyvERsUYOPUmqrUuoBy/v5Sqm+GK9+jMFGhcg6mzfDli3ncPPNMGNG5G2k/uKYaMeirg5Gj4Zly8Kn4vahlJK+QGJArGK3aqDN8r4DeE5rvTjaDkqpZ9xKmBDporUxanVpKdx9t9epyW6TJhnH8M474be/hYsuMpaHGijIsFUiJGrOR2v9nNZ6s+X9ZuC6OJ9X7VbChEiXX/0Kfvc746m9xBw0ajgPHOpU+LG65RYoK4PbboO+Pq9TJzKV05lMLwJKtNbPpy5J3pKBRYeXI0eMuor8fHjjDeNfkbxVq+Dyy+HJJ+Gaa441SpDrKufZbmXi9FK7Hnjd4T5CZKwnnjBGZX7pJQk8blq8GP7pnzbxta/5+NGPruQPf2gFjgWh0P8lVzl8OW3ttlZr/VC0lUqpS5NMjxBp09FhFLVVVsLf/73XqcktSsHhw1/jyJGJfPDBFRG3kX5Aw5vTZ71VZoBp01q3Rli/BMjZIjmRW+6/H7q64JFHkAExU+J1vvQleP75rzBr1q8pLPxI+k2JAU5zPu8BTwIt0tRaZLN33jH6o1x7LZx1ltepyU01NTU8YHbWeO+9oW2VpB/Q8Oa0wcFGYJHW+r0o65+J1RTbwfcsBPzADPPfBq316rBtKjCm7W4zt2nTWjc63SbCd0uDg2HgkkuMpsBbtxrNg0Xq3H03/Ou/wjnnXE9Ly797nRyRWvazs1pr2y/gnGTW2/yOhUCF5X0JsA1Yalnmx6h/su73LMYYc7a3ifL9TYFAQIvctW6d1kbvnjs1oGtqarxOUk7bt0/roqL9Gv5Pjnfus32vd1Tspi39fgbCnFLjlVLjo61PgF9r3WL5zk6MYXsaLNtUhb3HfF/vcBsxzPT1GR1KR436kAsu2ITWWlpcpdi4cbBixVjg71i1So63MDgKPpa5fKxmAAuUUtea/YASppQqAZaY/1o1muv95vuFQEvYNhsZXOdkZxsxzPz4x9DaCn7/SvLyZPKZdLn6ajj7bKiuhp4er1MjMoHTBgdDZirVWm/WxmgIT2IUkSXMzOX4zVdEZmDyYwz3E74vSim/nW2SSafITt3dRv3DeefBccfJ1FPpNGIEPPwwbN8Ojz7qdWpEJkhmGu1BlFI+YEEyiQHQWk+wFruZKoFOrXUb5uR1oUASgd/mNmKYmTr1UT780Oh/smVLK62trQSDwYGXFAelVmUlfP7z8C//Ah995HVqhNdiBh+l1DnmzKUblVJ9wLIYI1qvZWgdi1uqgNAI23ZyV45zYEqpJqVUE1DudF+R+T74ALq6ruO449YxfvyfIm4jnR5T76GH4NAhkFbWImYnU7MBwWbgQXPK7GIiDB6qjcnlUkIptRTo0FovT9V3iNx3110AeWzYMJ+ysvkRxxqTTo+pd+qpcMMNRh+rG280xtUTw5OTYrd/BTZprbvCX6ENkm1wEM6sm6nSWg8pzovQKCHS/rZzQFrroNY6CEQauUFkkfC5Y155BX72Mzj//A2UlUXfTzo9pkdNDYwfD9/4htcpEV6yPbyOGWS+D6CUilQ0VYrRjHmuO0kD8/Pmhy0LzTFUCgzU6VgCTRvHGhrE2kbkKOvcMX19MHcunHgirFlzQcz9pM4nPSZOhPvuM6ZcWLNGxtUbrpw2tb7MrN95Flgd9loJVLiVMKVUA1Ad3mjAfN/G0HqdUsxGCXa2cSudIrP94AfGLKUPPQRjxx5bLvP1eOvGG+Hkk40+V0ePep0a4QWnrd3maq3ztNanaK1PDn9h5oySZdbz1FuDhFKq0tJEuhFj2ByrCnM5DrYROayjA775TbjwQliyZPC62tragZ7WEnzSr6AAHnwQ3noLGlLVTElkNKdju12mtX4uxvriZBsfmOO6lWJ0CA0pxRhTrsrcpgR41loXpJRai1E/1GZ3myjfL2O7ZaFQURtAa6tRbVdU9CN27vwCs2cvZezYbdKcOsNoDfPnG51+334bjjvO6xQJF9huteM05xPP9GR2DgUMjCbbmyyvtRh9fYCBordqpVS9UmqhUmoZYTklO9uI3NHe3j7ofV/fGezc+QVOOOFXjB27DZCm1JlGKXjsMdi/H6ZPf2ZQIxGR+5zmfMZjFGV1YIwQvS9s3fe11kui7Z8NJOeTnZRSoYFhCQSCbNmygvz8ct55B0pLh24jMkd1NSxfDuXlN7F582NeJ0ckJ2XTaA+q/FdKWa9kRYwREIRIJWsz6d27L6Krq5x///djgSd8G5E57r0XHn30I95991aOHpXpzIeLRObzmR+tXset+Xy8JDmf7NbZCZMm7aGg4G90dp7KiBFep0hEY62n27BhGgcPPs2MGf/G1KnGZMhSR5eVUlbnc12cBgVDRj8QIp3uvht6eyfQ3f0l8vOl/iCTWevp8vN/RX7+OrZv/yqHDxvZVamjy22OMrjx5uvRUWY4FSIdXnsNnngCvv71PB59dJPXyRE2hEoYgsEgBw/+kC1b5jNjxvP89Kcy3FGuixp8zAYEoekNSoFGrfV2y/rpHGuBNhvYC2wzp1YQIq2OHoWqKpgyBf75n71OjbAjvA5uzJi/sGwZfOtb8NWvSh1drota52OOYt2IMcpA3PHOzBEJrtVaZ3Upu9T5ZKeHHzbGClu9Gi67zOvUCKdCA72uWdPEWWcZy954A8aM8S5NIiGu1Pl0aa0/bSfwAJgdQFM2urUQ0bz/vjFW2Oc+B5de6nVqRCJCwx2NGaP4u797im3bQKrrclusOp9Bw9CYk8UNYi2Gi7SPEKmmNVx/vfH/xx4zOi6K7FNbWzuocUhBgZGbXbIEZs/2Ll0idWLlfMJHApgALAK2YUzuFmm6Ahk9QKTV008bIyM/8ACYrXZFDnjwQZg0Ca65Bnp7vU6NSIVYwWdQZZDWerPW+kFgndb6rijFcdLJVKTNzp1w661w/vlw001ep0a4qaTEmHBuyxZjRHIYOk+TyG6J9CVucT0VQjgUKm7r6YEf/hDy3B6lUHjuH/7BaDxSV2f83zpPk8h+sS7ZaLOAxsrd2J45VIhE+Xw+8vK+zIsvwgUX/DennOJ1ikSqPPYYFBXBV74C/f1Z3ZBWhImV86lSSkUaKmeCOd9OJCXADcknS4jopkyp4C9/+R5z5sCaNZ/2OjkiRUI5ncmTA2zYUMeoUZUUFtYPNMsGGYInm8Xq57MVYxpr258F3KG1zurnUOnnk9n6++FjH3udrq5Z/PGPo/j4x71OkUgVpRSBQACAt966m48+mkdR0QLmzDl2z2pubpaRyjOLK6NaN2qtHc1MqpRybRptIaxCT8E7dlzG3r1fp7DwNq6//lj1ozwB56bQQ2BnJ0ye/BH9/T9mzZppjB5trJcheLJX1DofrfX1Tj8skX2EsKO9vZ3u7um0tVWRn/9fFBT8cNB6GYQy91iH1ykpgVNP/TaHDk3jzjsjbyOyi6MpFYYDKXbLTEoVcuaZPezeDX7/Fyko6BzU6kkmist9tbW11NWVALdyxRU/5+c//5LXSRJDeTaNthAp8YlPNPGHP8BTT0FBQeeQ9fIEnPtqa2s5dOhWzjkH/vu/v8T773udIpEMCT4i4z33HLz++nncfDN85jPHxgGzdjaU+p7hobAQnnnGGPXg8stl9INsJsVuYaTYLbO8+64xttfpp8PLLxtjfgmxapURfJYtg3onbXJFqkmxm8h+Bw8aPdwLCoynXQk8ImTJEmOEi+XL4aWXvE6NSIQEH5FxQmN4FRU9xZtvan72M5g2zetUiUzzne9AeTl8+cvwzjtep0Y4JcFHZByfz8fJJ68ArqKmRvFpGcRARFBYCC+8APn5cMklMG3amTLwaBZJZGBRIVKqo2MOW7fexBe+APfe63VqRCbz+YzZaxcsgPHjV3LhhffQ3Pxbr5MlbJDgIzwXGr0A4ODBabz55nfJy3uLPXvuYP78Q4CMYCAiC507Pt8lbN36//Paa5+Tsd+yhBS7Cc+1t7cD0Ns7njfffAClDlNUdAX5+YcGtpERDEQkoXPnhBP+k5Ejn+Lw4dvZtevvB9bLeZO5JOcjMsJvftPEpz5lDBw6a9bXKC6eOGQEAyEiCZ0nF144nz/84XS2bavmO9+p5rOflfMmk0nOR3junnvqWLwYXn0VfvpTKC7+05BtZAQDEYn1vMjL6+P002uYNQsWLYING+S8yWQSfISn+vvh/ffv46WX4HvfM24aMoKBsMt6XgSDQV555b9oaZlMQcFePvc5+PKXa6PuK7wlIxyEkREO0kdruP12o7/G/fdLyzbhnnfegfPPNzomNzfDjBlG44RQHVFNTY080KSGK/P5CJEyWkN1tRF4br4Z7rnH6xSJXDJzJjQ2wkUXwbx5RgAKtYyTB8vMIMFHpJ3WcMcd8PDDcOONsGIFSL2wcNvZZ0NBwWfZtes/OP30A4wcuYe8vA+kKXaGkDofkVb9/XDbbUbg+frX4bvflcAjUmfXrjWcffY36O0dR3f3b+jrO3nQemmK7R3J+Yi0OXIErrnGaNF2663wyCMSeETqbdq0kpYWOO+8Xg4fbuShh0qYM8dYJ02xvSM5H5EW+/fDxRcbgQe+yYoVirq6Wo9TJXJdqKl1RQWUl9/EiBGHmDfPqA+yrhfpJzkfkXI7dhgDP27ZAjNn1jNlyqs0NUkrS5F61vqcz372FDZsmA38F5/+9Bk0NIyQ+h4PSVPrMNLU2l2vvAIXXrgbpYo47bT7+eCDfwegvLx8YBup9BXp1NlpzAf0P/9j1Ds+8ogxMrZwhUwmJ7wRmotHKcXFF7/IvHnQ39/JOefcwMSJ6yPuI5W+Ip1KSowJ6G67zWjw8ulPw1//6nWqhh+J9yJp1lGpOzs7GT/+JEaN+hG//vV8Jkx4nb17P82GDXsBBpq5yrhtwkv5+UaLy7POghtugFmz4OmnYelS6YiaLpLzEUkLXawAR4/OZf/+/2X37iDTp6/krLPuBDoH1kcaOkcqfYVXrrrKGANu4kQjB9Tf/69ccMF8tNYSeFJM6nzCSJ2Pc0opurs1NTXw8MN9FBb+ld/97gTOO+/YejnPRCYK5dr7+kaxbduN7Nr1BfLy/sisWd9l/Pg/A1In6ZDU+Yj0ufLKH3PWWUYxxuzZLfT0nMYnPyk5G5H5Qrn2ESMOM3PmI4wZczlal7B58+Ns3fo1+voKpU4yRSTnE0ZyPvZt2wZ33mlMYzxzJjz5JFxwgdepEsK+8Fx5MBjk6NEizj77JZ54AqZOhR07/pG+vp+QJ4/qdkjOR6ROR4cxGvVpp8GaNVBXZ/ThkcAjsk14rtyYluE3PPGE4uqrf8CkSQA/4ROfAHkedZfkfMJIzie6jz4yRqF+/HHo7oavfhX++Z9hyhSvUyZEavT3w89/Dt/8JnzwAQSDxgjsF10kQ0NFITkf4Z533oFbboHJkw/x7W/3s3//KqqqvseTT0rgEbktLw+uvBLeftvojPr221BZCZ/8pFHc3NvrdQqzl/TzERH19sKvfgXUTXHrAAAWUklEQVRXXvl/9PScj1JHyc9/gVGjHmH27LG89RYEg88A0hpI5DZrP7Y9ezYDV/Daa8tYtMhPQcHfOO+8P/LTnwY46SRPk5l1crrYTSlVAcwB2gA/0Ka1boyzz7AqdrNeWL///WscOTIXuJy8vMX0938MaMfnW8uUKb/hT3/6LTB4aByA5uZmaUotcpZSikAgAEBraysAs2ZV0NFxLjt3foGOjnPJy8sjGITLL4dLLzX6DQ1T9gsjtdY5+cIINmvDlj0L+OPs1xQIBHQuKisr04AGdE1NjdZaaxirzzjjm3rKlF9qpXZo0Dov75A+7rh1+owz7tSQN7B/TU3NkP2NzyDNv0SI9LGe34FAQIffH8Cnp017So8e/b42pko8ouG/9IQJdXru3Cv1hRcGdHFx8cC+o0aNGriOysrKdCAQGHQ9ZTnb9+iczfkopeqBDVrr1ZZllUCV1npRjP1yKudjzdm0trai9Th8vsV0dZ1BV1c5nZ1nAgWMHQujRv0vxx//O15//T7GjjX2t9NBtLa2VordRM6ynt+1tbUD/X5Cw++EckZaQ0tLP0eOXMaIEf/AoUPTACgs3EVPz4uceuoeiov/wJ///BJKDS5ByKHSA8n5ANsIy+UAJcZPzr2cT6Rcze7dWkNQz5jxqJ48+UWdl/eGhqPm01mfLip6V0O9/u1vtT58OHLOJoeeyIRICSw5I+s1dPPN39Hf+57WF1+sNXSa153WY8Z0a/ilhjq9cOEq/dZbWsMID3+Bq4Z3zkcpVQLsBSZorTvD1mlghta6Lcq+WZPzKSubyZQp5Rw+PIm33z5Cf7+PkpJz6OmZzKFDJ3HkyLGC54kTobh4G21tTwO/p7p6Ht/+9l0y9I0QSbKT8w8E5vG97/2OV1+FV1+F9euNVqT9/cb6ESOOcsYZ+fj9MH06A/9On260KC0pyZqm3bZTmavBxw9s01oPORBm8FmgozQ8SFfw6e+Hw4eNV0+P8eruhq4u2LfP+PfGG++ipGQaR4+OZceObvr7JwKTyM+fChzP0aPjhnxuQcFuCgt3MXr0ToqK2mhr+yU7d/4PkydHPnmlyEwIbxw6BG+9BW++CTffvJL8/LPo6ZnMwYOTgDFhWx9m1KhOCgo6OHCgjf7+XcBeiosVxx03khEjDvDBB3/glFOOZ8SIbt588/f09u4DejjppOOYPn0K8+ZdkI5rfdgHnwpgk5Pgo5RqMv9bnpd3evHHPrYCrfOAPPbs2Ut/vwLyGD16LKNHF7Fv3wHGji0G8tA6z9xWofUIQHHgwGHGjCmivz+fQ4f60HoUUIhShUAhWo908Iv6gP3k5e1m3LiDFBR0MHLkXnbubGHlym9x0knw619/l8cfvwM4PGgoeMnZCJH5rC3qNm9uRevjmTGjkp6eKRw5UkpbWzeTJs3iyJFSurvH0ttbglGLEB6kYullxIhe8vKOkJd3GKWOolTfwOvQoW6KikYNvId+y3rj/11dHZSUFKNUP2bpIsYtVaNUP3/962fqtNa1tn5zLt6Ykg0+cG5xYeFz5kHX9Pb20Nt7GOijoCCfUaPy2b+/i/HjiwDNgQP76Os7AvSRn5/H+PFFdHT8jYkTS1Cqj4MH93Lw4B7gMOPGFVBSMpoPPniH6dNPIC/POBk6OnaxZ897wD4mTx7D1Knj2bixkf37d1JUBHV1kSs64/39JGcjROazXsvRGjVEutaPHDFKSbq64JRTZrNu3Sa6uuAnP3mOF15YAxRSWfkFLrzwU9x3379w4omnoHUBu3cfMDvIjiA/fzTFxRPZs2cvEyYcbz5A57F/fw99fcY2eXmjGD16LAcO9DBmTBGg6Ok5Qn+/BvLIyxtBQUEhPT0nEum+G/E353LwIXqdT8xiNyAQ77jEu/Enu97ONhJYhMgN8a7lYDBIvKqAeNuk455krrcVfHJ1eJ1QY4JS60KzIYJ1fURlZWVxvyCURU7Veog/FYEEHiFyQ7xr2U4ddLxt4t1P7NyTbGxje/6JnMz5ACiltgGLtNYtlmV+jOK4CTH2y5rWbkIIkWFkYFGgEWNoHasKc7kQQggP5XLwqQbCRzKoMpcLIYTwUM4Wu8FAw4MlwAaMsd5aojU0sOyzo7i4+MTwwTOFEELE1tzc/KjW+lY72+Z08EmEUmo/UAD83uu05IhQFG/1NBW5Q46ne+RYuqsc6NZaT7WzscznM9QmAK110ON05IRQ/yk5nu6Q4+keOZbusvSVtCWX63yEEEJkKAk+Qggh0k7qfIQQQqSd5HyEEEKknQQfIYQQaSfBRwghRNpJ8BFCCJF2EnyEEEKknQQfIYQQaSfBRwghRNpJ8BFCCJF2EnyEEEKknQQfIYQQaSfBRwghRNpJ8BFCCJF2EnyEEEKknQQfIYQQaZfTM5kqpSqBBcAeYAawSWu9Ms4+KwDszkMuhBDCuZwNPmbgQWtdbVm2SSlVorVeHmPX8kAgEABuSXUahRAixyi7G+ZysVtVhGWNUZbH5PP5UEqhlKK2tjbphAkhxHCXszkf0wKMgGPV6fRDfD4fPp+PpqYmVxIlhBDDXc4GH631ogiLFwIN6U6LEEKIwXK52G0QpdRSoCVOfY8QQog0yNmcT4hSaiFG8Vu03FBouybzv+W0tkIwOLBuRWur8R/LMiGEEGEcVE3kfM5Ha71aa10FVJut3SrSnYbr169HNTejmpup3b493V8vhBAZJ+dzPiFa606lVAOwDpgQYX0QzBxQeXnAGsFvNXM8iTY4+HMwSCCJ/YUQItfkfM4nTCNQEuoDJIQQ6SZdNwwpCz5KqfJUfbaN7/YrpfbGKGIrSWuChBDC5PP5CAQCaK1TFnyyIcClMudzVwo/O54SoM18WfnNf1vSm5z40nGyZMMJKYSIzc51nI4Al6y4dT5KqXOAjQ4/VwE6oRS5QGvdopRaFWFVNbBcax0elDyXbEdWn89He3s7ADU1NRFPOOksKyKxc+6IzJEr17GdnE8bsE5rPcLBKw94LsVpj8nsz7NYKVWvlFpmNjZ41jrWWy7Jhied4SZbcppSDCS8EDf4aK27SGA8NIxchqe01iu11tVa6+Va66p4I1qL3JApNzo3buqZ8luSlQkPR7lyLHOFrabWWuv3Evjs4gT2EVkuE4pwcqVYAnLrt3hNjmVmSWU/n7uAJSn8fOEyNwKHXOBCDBW6LgBazRFTgpYRU4LB4LDLjcUtdlNKnaOU6nP46scYxFNkkUwoGhGp5/P5CAaDA6/W1lZaW1sHLbP+/TOluCpT0pGI0ENdNHV1dWlKSeawk/MJNTj4lJMPVko9k1iS3GP285mD8Rv8QJvWOnyKhSHWr18/6Kkkm59UsvGJKxOK7hKVDce7vb19II3R1NXVDaQz0dys28ci23PVoXQHI4yYopTtOdhyRtzgo7XuUkplXYMDpZQfqNdaL7Ase1Yp1RavqfXhw4fjfr714owkU25C8W408X6HF7L5JpMtx9t6bFN1M8yWY5EONTU1Sa2Pdz8Jvc+m45nKBgfzgScT2M8tVQydu6cBqAeijm4dkuzF6faFFyk3YOeEtKY7V564Ej0W6bo4kzne1t8BqXlwiXejs7uNHek89xI5LyIVMaYi1x3vc+Ktt5tbDR3fdDzwJnusEmpwoJQaz7HRAiIpxcj5eBl8Ik0ctxFYG2/HsrKyuB9uvTij/RHcvPAi5QbsnJDxuHGTSXcuL9FjkY4n7WSfcNPxO+zs68ZxcnIs3LjpJ3JehB/LZHPdqSwyjnU/gfj3FDceeMPXJ3OsEm3tNgPYBOw1X1Z+YBsJTFftFqVUiZmODutyc2RrlFL+WEVvdm7o8U7YZG9CdiV7Qj711FNJPy1lSvFKssfCKtGbSLJPuOAs152qm52TB4poaXByLFJZ1Jru3Fcqfofd+0WqH3jdlGjwaQNWaq2vj7RSKTWfsBt/mpWCEWyirPczdNw3V8W78Kw3fUjsxu9G8YlbgcProj23i5JSfeGFviP8pu30d6QqnU7Oi1SlwY0iyHQ9BDoRDAapq6tDKWX7gcHONpn4W2NRWic2BJtSqtgc/SDa+ku11s8nnLIkmK3cNmmth9z1lFIaWBDe6s06k2lxcaC4vLxpYF3opC8vjzxQdyLrm5sVxcWbB953d3cDMHbs2IFlXV3nEAhoV9IQKx2xvsO6Pprt22vx+WqjfoZ1fSTr119PYeGx55hIx6Kk5Jcxv8PKzrGIJ95nrF9/PYcPG6W6ZWU1EX9fqv5mTj8jnu3ba2lvN5r6hn6Lk/MiVb8jU64RJ9z4e7jxHV6dv01N2H7STLiTaazAI+yx/tEiX3zHlocuvNB7GHxDTlRZWeynIev6aCdsvDTEW3/4cMOg4BNJe3td0r/Vys7FF0thoREwY90ASkp+SXt7Hc3NiX1Huvh8Qx8OnJwXdiR6LFJ9jUR78HH7OnMi2XPTDjvnb7S0hY5XpGOl1Dm1WutaO5+VcM4n6gcea4ywRGvtybQKoZwPMCG86C1azseyvikQCASsRQi1tbUDncAiZZOj1THE2j/0ivUZSikCgQAQ7cJrJvT3i5cGN36Hne+ws004pRTW8zCRY2EtfnEjnW4ci3jSkU43pCoNkeqVwm+Gduq/krlGrPvb+YxIRaV2foeTRjfpuA4T/Qzr8dq+ffvAsSgrK8Pn84WOla3cT6Kt3eJNs9ACXJfIZ7skVJ9TiqXhg9kQwbrelvBAAc4qZCPtb/dEtFuXYqccOVI60i3Reo54rHUQiZSph9Jm92+aLpF+ixuNAZIVLw3h6YgkXr1Sc3OzrbQkW9/otIFHeP1Wulta2jm/E7kG7NSxQeyA5aR+N5kGB89prRcnuH9Kma3a2hg6Y2kp0OnGfD7WE66kpIT29naam5sHngDcONmcVCBmQmCB+Cd9pIvX7UCc6LFIR6s9pwEu0m/JhMYAbt1wkw0cTq6RSOemWw1V3GxpGY+d8zuRayD8bxrpvmZDnd3vSyj4mKMeeD5lQhyNGEPrWGctrTCXu8KtJ4Bowovlwi8ct4NNojkGq1QFwUxouq6UGlieqqf9bGldGC8NdtLhxt/Uzk3Y+v9ESiDibZPOTrvJsJNbjfeQEu9vare+B5KYRjvBUQ/SqZqhIxlU4dKwP27fDIPBIM3NzVEHTaytrUVrndJBPyN9h893bBDKSANQpqsoyslNJpp4v8Va9p8oOwNENjU10dTURHl5OeXl5QPv7eZO0t2kNtK56cYN1+nfNN414hU3Alg6WAc3LSkpoauri+bmZrZv3277M9w8txw1OFBK+YBK8+0zWut9rqUkBcyGB0uADRiNIFriDSwaqcHBcBavQhcGV8jGY6eiszbJhhHRuFE5Ha+BR3jjiXDWp+9In+E055gNDRKy6TMinXvxGhRYH8ASTYOT70hUvHMz3nq7X2N7y9CTbrwXcAfQb3n1AfPs7p8tL6ApEAhoYTBOEUMgENCRjo11m0jKysoG9i0uLtbFxcUD7wOBgK6pqXGUppqaGg1owNG+8X5LvPXW74p2LJykJ9pnOBHpM9w+3omkwYvPSPS8iAeIeTyt500y56bd70hUvPS4dMzs32ttbWQMEroROMd8X4yRA9oAjHfyhZn+kuAzmBs33HRcWHbE+y12fqvd9Xak6jPSfbwzOXC4wclDSyZ/R5rYvtfabXCwFJivzY6l5r+NSqlt5rqHbGe1RFZxqzw7EyrI3ag3yjTRGomk83hnckMVN6Sjji3bhsZxg90GB3t1hBENtNHoID13DpG1svHCytTK7XCRGomk+3inozGMl9Lx0BLesjX83MvF42o3+MQaodrdIRJExkr0hpyNOY54N1Q3glOqAlw2Hm9xTK4H8xC7wSdWgImY81FKXeQ8OSKTDZeLwg43joUcz+yTLTnibGA3+ISPFGAVLTAlMvW2EGkhNxGRCHlgcI/d4FOllNoT6QXUR1jehzGTqGeUUpVKqXql1DKlVINSaqmX6RGGTLnpD5ebSKYcbyHC2epkqpTaCtQ7+VzgDq31KYkmLBlKqUoAbelQqpTaBKzSWi+Ps690MhVCiMS4Pp/Paq319x2lQCm/k+1dVgU0hC1rNJfHDD5CCCFSz1axm9b6TqcfnMg+LlsQYVmsVntCCCHSJNEpFTKa1jp8QFEw6qDCc0MDrNNo09oKYaO9CiGEiMNBdUXCo1pnE7OxQUu8+h4hhBDpkZM5nxCl1ELM4rcouaEBWuuguU8T5eUBJxFcCCGEMzkdfLTWq4HVSqkSs7XbdVrrlnj7CSGESK2MDj4OW8x1aK0jNijQxrTaDcA6YIIriRNCCJGwjA0+ZuBx0rdoA7GbUTcCJUqpSh1nQjkhhBCp5Wgm02xgBq1NGFNAtIQt3wYsMovjou2/o7i4+MTw2TqFEELE1tzc/KjW+lY72+Zi8KkAvo8RfDotyyuBtcAMrXVbjP33AwXA71Od1mEiFMVbPU1F7pDj6R45lu4qB7q11lPtbJyxxW6J0lq3KKVWRVhVDSyPFXhMm8zPCbqdtuEo1H9Kjqc75Hi6R46luyx9JW3JueADoLVerpRaqpSaAewBZgDPaq1Xepw0IYQQ5GjwAZBAI4QQmSvn6nyEEEJkvmExvI4QQojMIsFHCCFE2uVsnY8QucTsQjAHaAP8QJt0lk6cOe6jH6Mxkh9oiNX/T9inlCoB6rXWVbG2k+AjRIYLjfahtV5gWfasUqrNRtcBEcYMPG2hYGPeLDcppUqloZIr6oHSeBtJsZtD5iClUecFEvEppRYqpZYppRqUUmvNm4GILtLMvA04G35KHOO3jn5idkavJ8Z8X8Ie80EpbuAByfkkwlZUF5HJU2dCIk2EuBFjxA7hgHm+LVFKrQwbiLjRXO+X3GRSQiPJRJpJehDJ+TjgJKqLqOSp0wHzZukHOqzLQzdOhyO/D3vmcfObL+EicwizZ+xuL8HHmVBUFwmwPHWWhK0aeOpMf6oyXikcCzYRyDFzSGs9IcK8XpVAp+R6klIS4zwdQoKPTU6juhhKnjoTEh6oRWpUAQ94nYhspZRa6LS1oNT52FdiTkrndTqymtY60mR+8tQpPKOUWooxGWWs+cBEFGZJhu0cT4jkfGxIJKoLR+SpM44IRZXCBWZRb5W1GbtwbHEifc4k+MSRaFQX9shTZ1yh3OCghi6WYCS5xeTUA/O9TkS2Mjs/b0xk32FT7OawMrvDUnG2WJoAD5XE8Qz/jCqt9Wz3UpZbzKLeNobW/ZQiRZVJMfvrVTupJBdDzAFmKKWWWJZVAH6lVD2wIVqp0bAIPqEe4g522QAsTyaq57JEj2eE5fLUaU8jxkVubaFVYS4XCTBz3PXW4G02KpJRIxyI9GCulFoGzNVaV8faV6ZUiME8QWeELa7AaK21mhhRXcRmPnXWy4Uen1nE9mzY8DprMXKNcvwcMjs6lzL4wbIUWBRvPDIRn5nj8WutF8XcToKPM5aoHvPAiujMoN4oT532mbnwJRi5SD/QIgOLOmcG8r1RVrdprcMfNoVNZolINbAYo5h4JcaAreF9qoztJfg4Yzeqi8jkqVMIARJ8bHMa1cVQ8tQphAiR4COEECLtpJ+PEEKItJPgI4QQIu0k+AghhEg7CT5CCCHSToKPEEKItJPgI4QQIu0k+AghhEg7CT5CCCHS7v8BLA35iVADzh4AAAAASUVORK5CYII=\n",
      "text/plain": [
       "<matplotlib.figure.Figure at 0x7fe01d6bc2d0>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create the samples\n",
    "size=5e3\n",
    "\n",
    "sample = norm.rvs(size=int(size))\n",
    "\n",
    "values, edges, ex, ey = hep_spt.errorbar_hist(sample, 40, rg=(-4, 4))\n",
    "centers = (edges[1:] + edges[:-1])/2.\n",
    "\n",
    "# Extract the PDF values in each center, and make the pull\n",
    "ref  = norm.pdf(centers)\n",
    "ref *= size/ref.sum()\n",
    "\n",
    "pull, perr = hep_spt.pull(values, ey, ref)\n",
    "\n",
    "# Make the reference to plot (with more points than just the centers of the bins)\n",
    "rct, step = np.linspace(-4., 4., 1000, retstep=True)\n",
    "pref = norm.pdf(rct)\n",
    "pref = size*pref/pref.sum()*(edges[1] - edges[0])/step\n",
    "\n",
    "fig, (ax0, ax1) = plt.subplots(2, 1, sharex=True, gridspec_kw = {'height_ratios':[3, 1]})\n",
    "\n",
    "# Draw the histogram and the reference\n",
    "ax0.errorbar(centers, values, ey, ex, color='k', ls='none', label='data')\n",
    "ax0.plot(rct, pref, color='blue', marker='', label='reference')\n",
    "ax0.set_xlim(-4., 4.)\n",
    "ax0.set_ylabel('Entries')\n",
    "ax0.legend()\n",
    "\n",
    "# Draw the pull and lines for -3, 0 and +3 standard deviations\n",
    "add_pull_line = lambda v, c: ax1.plot([-4., 4.], [v, v], color=c, marker='')\n",
    "\n",
    "add_pull_line(0, 'blue')\n",
    "add_pull_line(-3, 'red')\n",
    "add_pull_line(+3, 'red')\n",
    "\n",
    "ax1.errorbar(centers, pull, perr, ex, color='k', ls='none')\n",
    "ax1.set_ylim(-4, 4)\n",
    "ax1.set_yticks([-3, 0, 3])\n",
    "ax1.set_ylabel('Pull');"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Plotting efficiencies"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's suppose we build two histograms from the same sample, one of them after having applied some  requirements. The first histogram will follow a gaussian distribution with center at 0 and standard deviation equal to 2, with 1000 entries. The second, with only 100 entries, will have the same center but the standard deviation will be 0.5. The efficiency plot would be calculated as follows:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<matplotlib.figure.Figure at 0x7fdfe4f21990>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create a random sample\n",
    "raw = np.random.normal(0, 2, 1000)\n",
    "cut = np.random.normal(0, 0.5, 100)\n",
    "\n",
    "# Create the histograms (we do not care about the errors for the moment). Note that the two\n",
    "# histograms have the same number of bins and range.\n",
    "h_raw, edges = np.histogram(raw, bins=10, range=(-2, 2))\n",
    "h_cut, _     = np.histogram(cut, bins=10, range=(-2, 2))\n",
    "centers = (edges[1:] + edges[:-1])/2.\n",
    "\n",
    "ex = (edges[1:] - edges[:-1])/2.\n",
    "\n",
    "# Calculate the efficiency and the errors\n",
    "eff = h_cut.astype(float)/h_raw\n",
    "ey  = hep_spt.cp_fu(h_cut, h_raw)\n",
    "\n",
    "plt.errorbar(centers, eff, ey, ex, ls='none');"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 2",
   "language": "python",
   "name": "python2"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 2
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython2",
   "version": "2.7.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
