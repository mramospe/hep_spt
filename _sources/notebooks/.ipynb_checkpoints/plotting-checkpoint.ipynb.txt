{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Plotting"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Import the modules and set the matplotlib style\n",
    "import hep_spt\n",
    "hep_spt.set_style()\n",
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "from scipy.stats import norm"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Plotting a (non)weighted sample\n",
    "Use the function \"errorbar_hist\" to plot the same sample without and with weights. In the non-weighted case, the errors are considered poissonian, so one can see asymmetric error bars for low values of the number of entries."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<matplotlib.figure.Figure at 0x7f6f8131ee90>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create a random sample\n",
    "size = 100\n",
    "smp  = np.random.normal(0, 3, size)\n",
    "wgts = np.random.uniform(0, 1, size)\n",
    "\n",
    "fig, (ax0, ax1) = plt.subplots(1, 2, figsize=(10, 5))\n",
    "\n",
    "# Make the non-weighted plot\n",
    "centers = (edges[1:] + edges[:-1])/2.\n",
    "\n",
    "ax0.errorbar(centers, values, ey, ex, ls='none')\n",
    "ax0.set_title('Non-weighted sample')\n",
    "\n",
    "# Make the weighted plot\n",
    "values, edges, ex, ey = hep_spt.errorbar_hist(smp, bins=10, rg=(-7, 7), wgts=wgts)\n",
    "centers = (edges[1:] + edges[:-1])/2.\n",
    "\n",
    "ax1.errorbar(centers, values, ey, ex, ls='none')\n",
    "ax1.set_title('Weighted sample');"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Calculating the pull of a distribution\n",
    "Sometimes we want to calculate the distance in terms of standard deviations from a curve to our measurements. This example creates a random sample of events following a normal distribution and overlies it with the original curve. The pull plot is shown below."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAZ8AAAEECAYAAAD3QzkUAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMS4yLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvNQv5yAAAIABJREFUeJzt3Xl8VPW98PHPL2EJAklIBCpSMgR3sIaIttcqMyq4tL70WkGrrY+9XgW9atW2guiVJF30ktoW660V3Ku2RWJrV7VE78SnjxsQUr1aqxKIBZUtBAy78H3+OGfCZDLLObOdmcn3/XrNC+Zs85uTM+d7frsREZRSSqlsKvI6AUoppfofDT5KKaWyToOPUkqprNPgo5RSKus0+CillMo6DT5KKaWyToOPUkqprNPgo5RSKus0+CillMo6DT4RjDELjTELvU6HUkoVsgFeJyAH1fj9fj9wo9cJUUqpPGOcbqg5H6WUUlmX8zkfY0w5sEBEZkcsrwWmAO1ANdAuIs1ut1FKKZV9OR98gAVARfgCY0w1VkCaHrZsqTGmXUTanW6jlFLKGzld7GYHkIooq2YDiyKWLcIKVG62UUop5YFcz/lMA5YB0yOWz6BvYFlhb+tmG6WU6mXfvn2sW7eO3bt3e52UnFVSUsLYsWMZOHBg0sfI2eBjjJkGPAVcHLG8HKv+pjN8uYh0GWNCuaXORNto0ZsqBD6fj46ODgDq6uqor6/3NkEFYN26dQwfPhyfz4cxjhtv9RsiwpYtW1i3bh3jx49P+jg5G3yA8lCwiFABViCJsV916D8JttHgo/Kez+fD5/MRDAa9TkrB2L17d84HnqamJjo7O6moqGDGjBlZ/WxjDJWVlWzatCml4+Rk8DHGzBCRphiryx0cwsk2kZ8ZtP9b43ZfpTLFytnsAT7Hl798A1OnnsfgwTByJEyaBCLFGLPf62QWnFwOPABLlixh6dKldHXFer7OrHScn5wLPnaxmjdnVKkc8fHHsHgxbN78AjABgD/9yXqFKy7+PZWVL/P883DWWZDj90yVZuXlrp+zc0Yutna72ElfHDtIpbxNiIgERCQAtDndR6l0++gjuPpqqKqC+noYMOATqqt/TjAI69dDdzds2QJvvQVPPgkjRwbp7DyZc86Bz30Ofv97EPH6W6hUNDU1MX36dJqammhsbKSrq4vGxkaam5tZvHgxra2ttLe309TU1Gddon2bm5uZPn06zc3NNDY20tra2vO54dtF7pcRIpIzL6AWqI1YNgtYGva+HBCgOmK7nuVOtomThqDf7xelMq2qqkrs61Hmz6+XH/1IZNgwkUGDRK67TuTdd0X8fr/Eux79fr+cdtqZ8thjIsccIwIiZ50lsnp19r5HoXn77bd7/n/jjSJ+f3pfN96YOA3V1dUiIrJ161aZM2eOLFu2TERE5syZIyIiM2bM6HkfuS7RvrW1tSIisnr16p5lixYtkqVLl4qIyIIFC6LuF+88hXF8v8+1YrcpwARjzCVhy2qBamPMAmC5iDQZY9rpW69TAXTJwU6mCbdRykuhxgK//GWQyy+HF1+EL38ZFi6EI45IvB9AW5uVUX/44QAjRxazb9+/0tJyNTU1Jdx/P1x2Wea/h0q/2tpawCpWa29vp6uri9bWViorK3ttF21don0rKvp2nVy5ciWzZ1uDyMyZM4eZM2fG/Mx0yangIyJ98nfGmDnASSIyN2xxM1agag1bVmsvd7ONUp7avv04Jk+2itMeegj+7d8S19t0dHT0BJ9wRUX7GTv2aVav/hEnnriWr30NXn0VfvITKC7OTPoL3cIcGN/+pJNOorq6mtraWqqrqx2vc7I+ZMKECbS3t1NbW0tXV5fj/VKRU8Enhmhhdy6wFAgPVrPtl5ttlPLMpk1Teeed2/H5IBiEY4/tnauBgzmbQCDQa99Q0+rQ8vCm1sYYWlrgllusm+e99/4B+Cp1dbdoP6A80NzcTGtrK62trdTW1jJnzhwaGxvp7LS6LVZUVNDa2kpzc3OfdUDcfcHKLYX2b21tpaurizlz5jB37sHn+8j9pk2blvbvaSRHayftzqJzsTqZlmMFkUUi0mqvrwUuAZZj1fO0SvSBReNuE+Vzg36/36/9JlQmPfEEXH75fkpL/877709i5EhruTEGa0YPSyj41NQc7AHQ0tISqp+MGnzq6+t7gsyRRy7k/fdvYOrUYv78Zxg6NHPfqVD8/e9/59hjj/U6GTkvxnly3N4yZ3M+dr1MzJyKHYRao61zs41S2fbEE3DFFVBe/jcmTbqNkSOf67U+PJDEytnEE567OfzwZxg4cDt//et8vvQlNACpnJGzwUepQjRq1Gw2bbqP8vK/ceDAebz55s5eRWrhuZ5Y6urqXH7mi8yfP5+vfQ0uuMAKQIMGuU25UumVi/18lCpIr7wCmzYtZPjwd5g06TaM2dlnm5aWloTHSabe5qtfhYcfhhdegKuu0r5Aynua81EqC95/H84/H2A9q1dPZOTI55IqUosUCARoaGjAGNMzsGi0ptihz/L5Lufxx/+dqir43vewl+ngpCr7NOejVIZ1d1vFXSJw/fV/7mlcEI3bIrX6+vqeTnuhoBEKJNGMG/c48BDf/z4sXWot8/l8+P3+XsdQKtM0+CiVQSLWcDnvvANLlsC9934z7vaRN/9AIEBLSwvGGFeBIRgMEgwGqampoaampud9S0sQuJYvfAGuvBL+/nfXX0lFERoF2+3fqT/TYjelMujee+HXv4Y774Qzz3S/f3izaacS5Z7q6m7jqqugthYuuggqK4dQXLzLfeJUj0xNbTF37lwqKyuZM2dOWo+bCzTno1SGvPYafPvbVl3P3LmJt0+XRMGqvr6esWOtoPiPf8C7734rOwlTrl1yySUJt2lqijX7TG7T4KNUBnR3w9e/DmPGwGOPQVGUX1qyRWqp8vl8BAIBvvvdAOPGPcTGjdN5/fUjCAQCPS8tOsoPXV1dLFu2zOtkJEWL3ZTKgG9/G1avtobNiTXlSjJFaukQPjbcuHFP8s9/HseuXT9i9+5ZlJRsAKChoUEDUBxOh0FKNpA3NjZSW1vba8oDODiDKcCsWbNYsWIFK1asoKmpqWdG08htcpXmfJRKsz/8wZoIbvjw+/H7va2EjpW7OtgA4UVOPPEeiosHUFKyhBdeCOqU3A7Ea1EYrqGhwfWxFy9eTG1tLdOmTes1plpoHp9Zs2axaNEiwBpzLXwq7Wjb5CrN+SiVRps2WZ04TzgBSkufpqjI7+nNPFruKrJBwpAhH3PEET+lpWUeCxdauTa3Tb77o0TDIEFy002vXLmSKVOm9FleW1tLZ2cnzc3NUadFcLpNrtCcj1JJiNW09sYboavLGr+tqGifdwmMI1oubPTo5zn/fLjjDqu4UIvc4nManJMJ4ieeeGKvUahDFi9eTHt7e09uqL3dmpYsNJV2a2trzG1ykQYfpZIQrWPms8/Cr34Ft90GkyZ5mz63jIH77oOBA2HWLB1+JxGnwTmZID5r1qyeKQ+am5tZtmwZXV1dVFdX09XVRXNzc6/6oOrqapqamqiuro65TS7K2SkVvKJTKignIotZurth4kRrxOhVq2Dw4NhFMbkmPJ333w/XXmtNbHflldb6/jb8TjJTKuTL3zqdUp1SQXM+SqXBHXfABx9AZ+dFnH221Vy5ra2Ntra2nG/CHN4o4aOPGpg61ar3+egja70Ov5OYV83m85kGH6VStHw5/PSnVo5hw4bfxN02mdZPmRY+PlxDQx0PPAC7dsF3vuN1yvJHtDH2VHza2k0ph6KNFu33n0Fr688ZMKCCN974BpB4iutcd9RRMGeONer11Vd7nRpVqDTno5RD0fp2fPzxuXR3H82ECT9nwIAdCY+RL02Yb70Vqqrg+uvhwIFir5OTdVoXHl86zo/mfJRyITxXs2/fMN599xZOOw1aWuZjzHxXU1znsuOO8zFs2Nd5663vU1LyeQYPvq9X7/1crb9Kh5KSErZs2UJlZWVe5FSzTUTYsmULJSUlKR1Hg49SDkXmWjo6vkFnp1XfE7pH5UvOJpGOjg6mTv0rI0a8xtattzJw4NO91hfy8Dtjx45l3bp1bNq0yeuk5KySkhLGjh2b0jE0+CjlUPjNdseO8axffyHXXgs1NdG3yXctLUHeew+OPnovhxzyU4LBs3vWFXKOYODAgYwfP97rZBQ8rfNRyiUReP/9GxgwoLtnKupo8rn5bSgHd+SRMHbsU2zYcDbLl/ddr1SytJNpBO1kqhJpaoKZM+HII3/cL+bCOfXUc3n99Sf5/OcreOmlg0WMSkWhnUyVyoS9e62J4UaP/pj33rslL3M1bg0YsAuf72H++lf4TfxuTEo5psFHKRceeADa2+HRRz+DyP5+06nwsMOeZdIkK/Du2dN7XaxBVpWKR4OPUg51d8N3vwt+P5x9duLtC0UgEOCll17kf//3LFavhp/9rPd6HX5HJUODj1IOLVwIGzfCf/1X/6r3ODh0zF845xwrAG/e7HWqVL7T4KOUA5s3Q2Mj/Ou/whe+4HVqvHP33fDJJ1YAUioVGnyUcuCuu2DHDvjBD7xOibcmTrTGe/v5z61J55RKlnYyVSqK8Dlsbrrpx9x3381ccQUcd5zHCcsB8+fD4sW7OOWU/8exx36/Z5DV8OF3Qu+1DkjF4irnY4wpNcb4jDGlYcuuMsbcZYz5SvqTp5Q3wivRt227GWNA76OWMWNA5Cds3DiN7u4jYm6Xi9NHqNzhNufTCAiwDPiNMWYJUA7cClQYY74iItoTQBWMt9+Gxx6Dm26CceO8Tk0uaWTEiNsYOfJBhg17H+g7i2chD8GjUuc2+CwTkacBjDHjgRnACBHZbi+7KM3pU8pTt98Ow4bBbbd5nZLcUld3E8OGwS23wAkn1FBe3hZlGx2CR8XmtsHB1rD/TwNWhQKPTcfqUQVj+/bjeOYZ6wZbWel1anJLfX09110HY8dCe/ssoo3SpfU9Kp5UWrvNAH4dsUzz2Spv+Xw+AoEAgUCAVavaeOONyxg4sJPnnz9XK8+jGDLEqgf75JPj2Lz5NK+To/KM2+AzwhhzhjHmFuAkYDFYRXDGmJ8D2vhS5a3wmUo//fRM9u8/laqqX1BcvAvQCvRorrgCDjmkg7Vrr+LTT71OjconroKPXd9jsIrfxovIdmPMZGA2sA2Ykv4kKpU9wWCQF18MYswCSkrW89ZbNxEMBvtUpivLgAFw3nmvsHNnFQMH/rvmDpVjyfTzWQ1MB2YCD4rIKmNMBbA8ov5HqbwSqiBfsgR27DiCY475HoMG3dFnvert17/+Kh0dsG7dQ8yd63VqVL5w289nMtBsvy0PLReRF4CTjDG+tKVMqSyrr69n7174z/+EoUPfZ9SoF/usV30ZY413t349/Pd/e50alS/c1vlcLCJHiMitwJrwFXYAqk1bypTywIMPWlMmjB+/GGO08aZTgQCcc441DFFXl9epUfnAbfBZEfb/aL/MihTSopSnQlMmTJ0KX/nKIXk7BbZX7rwTtm61Bh9VKhG3dT7hASdas+rYY20olePuuQc2bIDf/hb+5V/qaWio9zpJeWXyZLjkEvjJT+D66+Ezn/E6RSqXuc35GGPMVfb/JWxhjTHmeeAvaUuZUlm0ZYs1ZcIFF8C//IvXqclf3/ueNdNpfx/9WyWWTFPrEcaYTuABY8x7xpgtwAvAUhF5Mf4RlMpNd91lFbvpTTM1Rx4JV10FixZZdWchOtW2imQk2rgYiXYypgyrT0810A6sEJFtaU6bJ4wxQb/f79d+Hf3HBx/AUUfBpZfCI494nZr8t349HHEEzJgBjz9uLQtNt6C/q4LneJSbpIbXEZFtIvKCiDxg/7sNQJtaq3zU0AAi1r8qdYcfDt/8Jjz5JLz5ptepUbkq3TOZLkjz8ZTKiIPFQMfxyCMHuO46nTIhnebOhdJSa1RwpaKJ2drNGPM+Vj3OPPv9mcRvUGDQUa1VnvD5fPh8PioqgjQ365QJ6VZRAcY08oc/zGHy5OtZs6bvbKc6WGv/Fi/nMxd4Kux9J/C0iBTHeBUBT2c0tUql0fbtx/Lb31pTJhx6qNepKTxdXQ0MHNjJmjVXR51yQQdq7d9i5nxCk8aFvV9ljLk6wfF0ZCeVF0SseWhGjYKbb/Y6NYVqJwsXVnDddRVMmjSLysrXezU40JlO+ze3dT4nGmO+EmuliKyJtU4pr4XP17NiRQXbtk2mtPQezjsvoEVAGVBXV8dVV0F1NaxZMwsR02e96r9cNbU2xjwFvC4iGR1AwxgzA6sZ9wT730Ui0hSxTS1Wc+92e5t2EWl2u02Uz9am1gXKGIPf70fE8Ne/3oNIKaeeehVFRdZENC0tLSTT9UDF9+ST8PWvw7HHfpe3357vdXJUZjnOzrodXmeZiDwQ81ON+YqI/MblMSOPMQMrSDTZ78uBlcaYChEJTV5XDSwQkelh+y01xrSLSLvTbVT/EwwG+fWv4aWX4Jhjvs9LLx18FtFioMy49FKYPft91qz5d/btg4EDvU6RygVui92WGGO+YoypibH+klQTBFSLSGvojYh0YTXhXhS2zeyI99jvF7jcRvUjdXV1EVMmvNBnvUq/oiI4//zX2L37cAYNukaLNxXgvthtC1a2qpy+zaoNICJSnHRirFzOC8CZdtAJLa/GmsRugoi0G2NWA9PDczD2vlvFLlh2sk2MNGixWwH77/+GG26A44+fQ0XF69rjPktE4LTTrCF33n8fDjnE6xSpDMnYCAdrgBNFpCgTTa3tgFNtv6KyA0g1VtPvyH0xxlQ72SaVdKr89Mkn1pQJp58OI0a87nVy+pXQhHMffQT33ut1alQucBt8rk7Qou2uVBIDICIjwovdbNOALjsXU2FvF2vKqmqH26h+5u67YdMmWLAATj89oPP1ZNmpp8KXv2wFoa1bvU6N8prbUa1XRS4zxpQaY0pjrU+T2RwMbOXxNnSxTS/GmKAxJgjEqs9Seezjj+FHP4KZM+Gkk6wpsUUEEdHgk0U/+IE10+kPf9h7uY563f+4au1mjLlKRB6MWDwBqDbGjMBqpZbWaRWMMbOAThFpTOdxVf+i88zkhhNOgMsug4ULrbq3ww6zloeGO9I6uP7DbbFbn5lKRWSViDxtByXXOY547LqZ2eHNpcPWJfwsJ9uEiEhARAJAm6tEqpz33nuweDHMmmXNN6O89d3vwr591gOB6r/cBp+YTePs6RT6BIkULQDOjFgWar1WEfH55WHrnWyj+onbb4fBg+GOO7xOiQKYMAGuvhoeeABWr/Y6NcorcYvdjDGTsSr7LwEm28vmRNsUqyn0zHQlzBizCJgb2WhARLqMMe30zWVVcLBRAk62UYXv9ddh6VKYPx8+8xmvU6NC7rgD7r9/F6ec8v849tjv09amo173N3FzPnaR2g9FZApwN/AA1g2818tuen2kiKSlyMqu51kQ0UdnWlgT6WasYXPC1drLcbGNKmAiMGcOjBwJ3/mO16lR4Q47DER+zMaN09i+/eio2+io14XNTYODO4GL402XbYw5I9UGB/bwOgDl9thsYAW5mSIy234/F1gKLA7bdbb9wsU2qoD98Y/Q0mL1Kxk+3OvUqL4WMGrU7QwduogTTvgHxqCjXvcjjoOPHXQeAIgxvE4FVh3NSckmxq6TWRpjdU8uyC56m2uMWQAsx+q30yun5GQbVZh8Ph8dHR8Cb1JZWcns2TpZTy6qq/sWY8bA7Nlw3HF+Ro5siVivwx0VMrfD61yEFRxWE30YhfGpDK+TC3R4nfwXCARYt+4iVq++gT/+0erYqHLT/v0weTK8996HnHTSFbz00jKvk6RSk7FRrU+yh9GJ/qnG3O/yeEql3b59pXR0XMH06fClL3mdGhVPcbHV+fess8awfn3MqcJUAXIbfJYnWK8zmSpPhDopAqxYcSmffjqUrVv/jdNPPzgalLaeyk3Tp8ORR77Le+9dhjEjqau7Tv9O/YDbfj6JjE/z8ZRypKOjA4CdO8exd++/M2jQowwd2nsYQm09lbt+97ujKC4u49prN2ng6SdcTyZnjDkDa7TodhHZHlphj+82j/TM6aOUa8FgkPPOg+Libk488fd9hmrR1lO569hj4dpr4b774LrrYOJEr1OkMs1tzqcLq59MK9BljNkfetnrZsTdW6kMqaur4y9/gT/9CaqqHmfQoL49ArT1VG6rq4PSUrj5ZquPlipsboNPKzDC7lQaOadPyvP5KJWsefPqueEGOOIIOPzw6DO5a3FObjv0UGvct2XL4DfR/4SqgCQzn0/MTqZogwPlkZ/8BN591+pQWlS0z+vkqCRde6018vXNN8OOHb3X6bQLhSXl+Xwi1sebaE6pjPjgA2uE5AsvhHPOsVq16URx+WnAAPjZz+Cf/+w7/YXP58Pv9+scTAUiZidTuwFBaErrCqBZRNaGrR+PNegowInAVmB1lPl+8op2Ms0/F10Ezz4L77wD48Z5nRqVDt/4Bvzyl/Dmm3C0PfRbaNBR/W3mNMeteuIFn/1YjQvmOhkw1B6F+iod4UBl03PPwbnnwp13wrx5XqdGpcuGDXDYYdspL3+H44+fgzH0jHxdU3NwdC/tu5VzHAefeMVu20TkbKcjVduDfsarD1IqrXbvhuuvh6OOgm99y+vUqHQaPRpEbmfr1pPZvHlqzO2071b+itfPp9fUA/Zkcb2EF8NF20epTFqwwJqM7C9/sSaLU4Xm55xwwr1s2vRdXn4ZLrggAOjI14UiXs4ncvTnEViTxa3GmpYg2hTVOmK0yoq33rIqpL/6VWt4FlV46ur+kwcfhI8/hrkx2tFq3638FS/n06syyG7ptsoYM11EYpWua9cwlXH798NVV1kdEu+5x+vUqEwJ1eXcfLM1+OgJJ3yO8vI3om6j8k8yY7u1pj0VSrnws5/Bq6/CwoUwapTXqVGZ1tAA48fDunXzaWl5VZvQF4h4OZ9oxWoQP3cTax+l0mLtWqtV27nnwte+5nVqVDYMHQqLFsFZZx3Kbbft7tP/R+WneDmf2caYLZEvYG605fa6WVlKt+qHRKxZL3ft6ubZZ6soKtIn4P5i+nS44gpobIQ2R+1vVa6Ll/Npx5oW2ykD3JJacpSK7aGHrJZtRxzxEIcfPp5gsMPrJKks+vGP4fnn4fLLYflyKCnxOkUqFXGbWovIA24OZoypTTE9SkV1+OFT+fjj5ykvf5uNG+vZtEl6eryDdjbsDyoq4OGHrdlp77gDfvhDr1OkUhGz2E1ErnF7sGT2USqRTz+FDz/8L4zZz9FH/xfG9K121M6G/cO558I111it31pavE6NSoXbyeSUyrrGRoBT+MUv4LLLlkYd40s7G/Yfd98Nzc1WHdAbb1hN7lX+Sfc02kqlVWurNcnYxIn/y6WXxt5OOxv2H0OHwuOPWyNff/ObXqdGJUuDj8o5B+dtKWX69C2MHg0vvTSJeJkbre/pX77wBbj9dnjsMXjySa9To5KhwUflHJ/Px9Spfi65ZDvbtlXyq19Zlc0hOl+PApg/H047zWp+/847Otlcvok5pUJ/pVMqeC8QCPDhh+fz3nvf4q674NZbvU6RylXr18PkydYo2OXlZ1NcvEfn+/GW48pXbXCgPOfz+fD5fD3vV64Uuruvo6LiFZ599jaee060KbWK6vDD4YknrBlsR4++kaOPbvQ6ScohLXZTnuvoONhZdN++UnbufBRjNnHMMQebVWtTahWNz+fjzjsDfPazv+Djj7/E668fTyAQ6HnpA0vu0mK3CFrsln3GGESEffvg7LMhGNxLTc2NtLb+vM82SoUzxuD3+xEp4uWXb+fTT0+jpubblJW9CUBLS4teN9mlxW4qf4SaSd98M/zP/8DRR99Naenfo26jVKTQg+IXv3geq1Ydxfr19/LMM1BVpf2/cpkWuynP1dfXs2iRNVXCd74DX/3q3j6t2bT4REUT/lAycGA3kybdzt69cMEFsGOHPrTkMi12i6DFbtnX3GwNmzJ9OvzhD1Bc7HWKVD6qr6+36wbPwZg/ccEFRTQ16fWUZY6zmprzUZ5qbYULL4Rjj4Vf/UpvFCp59fX1iAgiz3LPPUU88wz8x39YU3Go3KN1Psozq1dbOZ6KCnjuOSgr8zpFqlDccAN89BHcdRccdhhoqW3u0eCjssrn89lNq0czYsTbGFPB88/DmDFep0wVmh/8ADZssKbhHj0arr3W6xSpcBp8VFb5fD7GjJlMV9dv6eiw6nuOOcbrVKlCZIw1/fbGjXDddTBkCHzjG16nSoVo8FEZFz6CQWvrOnbsuA/YxfHH38q8eX/TzoAqYwYMgKeeslq/XXmltUwDUG7QBgcq40IjGOzdW86OHb/jwAEfkybNo7z8b4COXqAya8gQ+N3vYNo0KwA98ojXKVKgOR+VJY88EuSsswB287nPzeNvf1vYs047AqpMGzIE3nnnaETu5corz2LJkmd57rlzvU5Wv6Y5H5Vx11xzH6ecAlu2wDe+8QRvvLGwVwdS7QiosqG6+jBOO+1uLrwQnn/+XG69VZthe0k7mUbQTqbp9cILcNFFMGwYPP88TJzodYpUfxJe39jW1gbACSfU8t57N/HRR+dzwgltvP56DYMGeZjIwqKdTJW3RODee62BQseOhZdf1sCjsi98xPQQYw5w5JE/pqrqYf72txrOOMNqkq2yS+t8VNrt2QPXXw8PPgjnn2/NtzJ8uNepUv1VqBQjEAj0eg9gzCW0ti5hyhT47W9hypTsp6+/0pyPSqv33oNTTrECz+23Wz9oDTzKK+H1idGmX6+rO5aXX7aGdTr1VKisvEOn4s4SrfOJoHU+yXviCfg//6cbkT3AldTVTdYfsMppoTqhvXvL+Mc/5tHZ+QUGDPgzJ5+8iIEDtwFoPzR3tM5HZc9nPzuFUaP+h8svh6KiNxg+fCp+/zaCwaD+cFVOC9UJDRq0jUmT5lFSMo9PPz2TFSseYvPmLwLaDy1TNOcTQXM+zonA44/DFVd0YswwfL5H2bJlHsbsp6ampmc7nU1S5arIGXIDgQDd3Uewb9+DvPGG1VLz6afHIPKhh6nMK5rzUZm1ciVMnQpXXAHwNm+/PYj29llMnnw8NTU1BIPBnpdSuSrkZp9OAAAW90lEQVSyj1kgEGDlyod4442BnHlmM3/6Ewwe3M4998DevVYxndYJpYcGH+XK+vXW2FhTpsC778LixTB//gs9g4NGr9TVTqQqN0UGkINzAu2juXkab7wBxrzOTTdBWdl6Nm3yU1paht/v12LlFGmxWwQtdovugw9g4sRf0N19MWD44heX8+c/n0ppqdcpUyqzjDFMmnQLa9Zcw44d1RQXr+SYY35DZeXLGCNarNyb42I3DT4RNPj0NmbM2Yh8kw0bzkJEGDjwl0ye/BxDhnzcs40+/alCFqoX2r8fjjuukQ8++Dq7d49h4kS49Va4/PJBiOz1Opm5Qut8VPL27rWGoff74aOPnmfjxmkcdtgfGT68lkMOualX4AFtDaQKW6jYuLgYLr10J7t3jwO+xsaNG7n8chg6tJN582DNGm/TmW8KOudjjKkFpgDtQDXQLiLNCfbplzmfAwdgzJhL2LDhTGAGUMH48bBmzXfYvPluKiuj9xCHvi2GlOoPDhyAv/zFmrDu97+3Wn8OGvQKe/Y8CjxNXd31/bFEQHM+xphqYIGILBaRZhFZDMy2lyuguxtGjbqaMWN+z5Ahm9iwYQlwGaNGreT44+fw2c+egd+/gspKa/tojQlAGxSo/qmoCM45B1at8nHyyTMZN+5h9u2rABYBG/jpT7/EEUf8lJNP/jp1dfUepzb3FGzOxxizAFguIk1hy6YBs0VkZpz9CirnEz6q7yuvvMnevTXAFykpmc6ePZ9HZBDFxTsYMWIlO3Y8xsCBzzJ58lE9+2tlqlLxGWPw+/0ArFrVxoEDExkx4lo2b57Krl3j7K3WMHv2eE47DebMOY0PP/wrYD24ReaOfD5fT+fXaOtznPPJuaxmhYX3AlYD1RHLyq2vHHe/oN/vl3y3davISy+JwH/IYYf9ToYNe0dgn1iFA/tl6ND3ZezYXwucLnv2WPvU1dUJIIDU1dWJiIh9vpRSMYT/RiJ/Q6tXi9x3nwg8I8XFO+zfn4gxG6Sy8v+Kz/egTJx4uwwbNlmmTj1d/H6/lJWVSVlZmfj9/p5X6PeYB5zfo91snC+vUJAByqOsk8igFLE+J4NPVVVVr4t6716RdetEXntN5Fe/EikvXyDwgMALUlra1XORg8iIESKnny5y2mktAmcLlDkOLnl00SvlCSe/EUCmTj1dTjzxSikpuUkGDvylDBnyQa/faVHRLhk27B0ZOPA3MmjQT+TII38kxx9/i5x00tcFhmb+i6SH4/t0QRa72fU6q0WkTxbQGCPAdInR8CAbxW4iVouy3bsPvnbuhG3bDr62b4c5c77P8OGfZf/+oWzceIADB0YzePA49u6t4NNPy6Kk/WOGD99EScnHDB26hqFDVzNsWDsvv7yUWDNV19fX51u2Xqm8E94op76+vqeF6Lx5P+DCC2/j5JP/jZtvfoS33oIVK7bQ2TkMGNzrGIccAqNHw6hR1r+jR0NlJZSWQlkZzJ9/E5/5zBAGDNjJ22+/wr59W4BdjB07Ep/vM5xxxik0NGS8frZ/9/OxW7mtdBN8jDFB+781RUUTyw49dCEiRYgUAUVh/zeIFPPJJzsYNqwUkWJ7WVGv/+/cuZchQ4Zy4MAAdu0SrAupBBhC5EUV3wGKi3dizBY+/XQdsIFhw3ZQWbmPjo7XmDixgiFDPmLDhtf45z/fAaCqqqqnnkfrbJTyXqKHvEAg0KsV6YED8NFHVvPtNWtg1qz5HHroRPburWDTpiJEDgVGAxWA82lYjdlHUdFeior22P/uw5hPMeYAu3Z1M3ToYOAAxuy3X9b/rWUH2L69k/LyYRhzAKsghrD/Cxs3nt0gIrG/aHhaCvHGlGrwgc+XDRnSROiE7969gwMH9mEFAjjkkBI++aSL0lLrj9DdvZ39+/cC+xkwwFBaOpzOzo1UVlZQVLSPnTs72bFjM7CH0tLBjBhRQkfHP5gw4fCei6Gzcx2bN78PbOeww4YyblwZr732PPv3b6coRptEJ02ctRm0UvkvvFHD2rVrexokjBtXxbhxR7F//1BeeeUtli9/l23bYPHiJTz11J+BwZx99oWcfvq53HprHZ/97FEcODCITZu2s3dvETCEAQOGUFZWwZYtW6moGNXzIP3JJ7vYv1+AYoqLBzNkyDC6u3dzyCGlQBG7d+/hwAEBDEVFAxg0aDC7d48l2n036ncqxBtTKPgAI0SkK2JdwmI3wJ/qTT3V9U62iXxaikaL1ZTKf+m4X2TjnmSvdxR8CrWfT7v9b0X4QmNMecT6qKqqqhJ+QOgpJFPrIXH/GSf1Uhp4lMp/TvrSJdom0Xon9yQH2zge7qQgcz4AxpjVwEwRaQ1bVo1VHDcizn4F1c9HKaWySEc4AJqxhtYJV2svV0op5aFCDj5zgciRDGbby5VSSnmoYIvdoKfhwSXAcqyBRVtjNTQI22ddWVnZ4eHTQCullEqspaXlHhG5ycm2BR18kmGM+QSr4fwrXqelQISieJunqSgcej7TR89letUA3SIy1snGAzKcmHy0EkBEAh6noyCE+k/p+UwPPZ/po+cyvcL6SjpSyHU+SimlcpQGH6WUUlmndT5KKaWyTnM+Simlsk6Dj1JKqazT4KOUUirrNPgopZTKOg0+Simlsk6Dj1JKqazT4KOUUirrNPgopZTKOg0+Simlsk6Dj1JKqazT4KOUUirrNPgopZTKOg0+Simlsk6Dj1JKqawr6JlMjTHTgOnAFmACsFJEFifYZyGA03nIlVJKuVewwccOPIjI3LBlK40x5SLSGGfXGr/f7wduzHQalVKqwBinGxZysdvsKMuaYyxXSimVRYUcfMAqcovUlfVUKKWU6qVgi91EZGaUxTOARdlOi1JKqd4KPefTwxgzC2hNUN+jlFIqCwo25xNijJmBXfwWIzcU2i5o/7eGtjYIBDKfOKWUKiTBoONNCz7nIyJNIjIbmGu3dqvNdhquefVVTEsLpqWF+rVrs/3xSimVcwo+5xMiIl3GmEXAC8CIKOsDYOeAamr8biJ4Iu8EAviBYBqPqZRS+azgcz4RmoHyUB8gpZTKNT6fD2MMxhjq6+u9Tk7GZCz4GGNqMnVsB59dbYzZGqeIrTyrCVJKpay/3JR9Ph9+vx8RSfp75sO5ymTOZ14Gj51IOdBuv8JV2/+2Zjc5iSW6WPLhYlIqWU6u73TclPuLfDhXCet8jDGTgRUuj2sASSpFaSAircaYJVFWzQUaRSQyKHnO5/Ph8/li1gslWq+UV3w+Hx0dHQDU1dUldbPT67v/cdLgoB14QUTOcnNgY8xTySUpPUSk0RgzyxgzgYMDiy5NNLCoUsodDRwqGQmL3URkG8mNhzY38SaZJSKLRWSuiDSKyOz+Hni06E55Ra89FclRU2sRWZPEscuS2EdlkD6hKq/otaciFWqDA6UySp/kM8/n8xEIBHpebW1ttLW19VqW7XOfjr97tGOEf9dc+J7ZkDD4GGMmG2P2u3wdwBrEU6lenLZqyvSNPdXWhfnQmihdkrlZOrlhJjpGqBFDPA0NDWn4hs6lqxl05DESfddsf89sKNgGB3YaaoEpWN+hGmgXkWZvU9W/OSl+yUYRjbYudC7auejo6MDn88Xdr6GhIe4N2skxwj8zYI+3GL7MmINzl6Wj1Z2XQt8r0fcsFAmDj4hsM8bkXYMDY0w1sEBEpoctW2qMac9GU+vQDxagra0NOHhRhf7v5Mkw1WMolSnxbpZg3TBD66Jdv4mO4eSGW1dX1/P/fH5gCP8eyazPR47qfJJscHBmEvuk02z6zt2zCFjg9kDJFAOlIxvdH7Pi6aD1Me4kc76ycTN08hm59vdN9tpLtK2TY2W73ijV31lSA4saY0o5OFpANBVYOZ8Hkzl+mkSbOG4FsMztgZwU0UTL7qcjG+30GOkocsj3YouQTD0BJ8qJht7n23lL5nw5/Y6p/Aa8OI+p/ga8zH0lKsZMVAwaKdG5SPW7Jjuq9QRgJbDVfoWrBlbj4XTVxphyOx2d4cvtka0xxlSns+gt2h8hHdloN8eIdSG4KbrL52KLbEhHPUe4XH5gSEeRbz4WJUX7DeRa8Xe8v3k6640yfT9INvi0A4tF5JpoK40xZxJx48+yCrCCTYz11fQd9y2tEl2Mjz76aK8/aqyLOpXPgPQ+DTm50UXbJtGPt62tjZqaml7vI7dJxw/cTTqSqaMAdz/wdPy4M3WDSMd1k46ipHCBQICGhgaMMVnNmafjXKQzgMX6m+dbsDciyQ3BZowps0c/iLX+KyLym6RTlgK7ldtKEelzJzDGCDA9stVb+EymZWX+spqaYM+60MUSfoMMl8z6lhZDWdmqnvfd3d0ADBs2rGfZtm2T8fslpTS0tJi4x0i03s33jPcZoe8a63u6OReJxDsXTtOR7N9j7dp6fL76lNIZ7tVXr2HPHqv0uKqqrs+xEx0j0f6xjpHO68bJNmvX1tPR0RA3ndG8+uo1lJRYz8DR/mbl5c84PlasdKbjXDi59kLHSHQu0nG+k70uEq0PBnH89JX0ZHLxAk++27793Z4TCwcvlvBlbi/qaKI97fe+qFM6PGBdWKmsT5fIHEXk90z1XES7CYX/vdymI9m/R6rXRKSSEut7xbvRuN0//FxB9PNVVuaPe9zw66a8/Bk6OhpoaXEXOML5fM6Ddrg9exb1+i6ROjoaUv6bJPqNFBef2HPuUrn2QpI9F24ke10l+p0ZM7leROodHUxE0voCSoEa4K50H9tFGmqxRtUuj7JOgGlx9g0C4vf7e15VVVVi7ydVVVXitx5RJCS0XSx1dXU9+9fV1fUsCxftGOHbRFsfSovf75eysjIpKyvrlW6/35/yMRLtHymZ7xHtfbxjhP89QsvD/2axzkWiv1n4+2S+R6Ro6Uz0Pd1uk8z6yOs72vlyc307Ee03kA6J0hm+PtrfI/z6T/Y3kI5rz805ycZ1E2ub8O8a577o6D6dbGu3RNMstAJXJ3PsNAnV51QQ1vDBbogQvj6mRGXoifowhJfh1tfX9ynPdVK+G75NtPLubHT0c9tCJppE+zuprwg/Rqwy71TrYxKlIx0tn9JR9p+OY7jpvJkO0X4D6ZBqo5x0NSJJ9dpL9W8eeh86TjL1Y+GfEe9z4v1O3Fw3qTQ4eFpELk5y/4wSq1VbO31nLK0AuiRBS7eqqipXn1deXk5HRwctLS1UVVXh8/nSctMOF+vHm44K8EQtZBJ1FMyF5sXpaD3oRrKV3+kI9qkeI9vnKpPS0agh1UCcjfPpNkgmE+wjPyPafc0Bx50Pkwo+Yo164PmUCQk0Yw2tEz5raa29PC6HJzltTwDJcnvRR7thpuMm09DQ0HMuvGqK6jYnmY7PS/Z4ToM9JD8yQKJceSJeP0xkSzoCR7auvVQfNJ3knpyU+MQjTut7SGFUa0lu1INsmgvMjFg2mzQN+5PuZo2BQICWlhZXvYXdXvT19fU95a3hT0iJBINBgsEgNTU11NTU9LwPvRIJH4nByfdM5ly4legzMpWGXMhRuB0ZIxt/D68kU/yd6rlI5hjpCJLhI6aUl5ezbds2WlpaWLt2raM0OE2HY04rh6y6JnzAVfar1M2+XrywcjoLsEY7mEOchgZh+wRTrVz1QjoqdJOtZMdFpW+y0t0wIhuSbQzgZptU1ztJZ76I9htwc92IpH4uMtWwIh2fkeh3mI7fqbi4PzvO+RhjbsHuXGq/thpjTk8+7GWeiLSKNZNpk1izmRbsiNbRcjVuRXsic3KsbHRuczPOnZdP6r4Ux9dK98gXTtYXSs4m2m/A7fiIqZ6LdPwOM/UZudYJ1VEnU3vEggXA1SKyyhhTBpwE3AWcKSLbM5vM7DHGBP1+v1+HmOkrVlmz222SYYwJ5Uxj1nM4uZYzzRiD32/1kYnen6Ml7veIlGibVNcXuny5bgqI48pupzmfWVhBZhVYDQ7sXMTF9jrVD3j5hJxrT23xxKsjC+dV/UF/kk/XTb/jpGwOuD/OulvclPPl+os8rfPJFdko887lOopEdU9uz0mq3zWXz1W26bnIirTX+cQboVrzrKpHNsq8c1k6+p2E05yNKlROg0+8ABO1jM8Yc4b75CilwqUazDV4qVzlNPhEjhQQLlZgSmbqbaUS0huqc/09JxpOr5vc4rS12wH6ThoXUk7fYrlyABEpTil1KTDGTAOmA1uwJ78TkcUO9tPWbiot6uvre5ry5vPMsEq54Li1m9Pg8z5WU2s3CbhFRI50sU/a2IEHCevXY4xZCSwRkcYE+2rwUUqp5KR9Pp8mEXnAVQqMqXazfZrNBhZFLGu2l8cNPkoppTLPUZ2PiNzq9sDJ7JNm06Msi9dqTymlVJYkPZNpLhORyAFFwRrfLTI31CN8Gm3a2sDByL9KKaXCuKiuSHpU63xijJkFtCaq71FKKZUdBZnzCTHGzMAufouRG+ohIgF7nyA1NX43EVwppZQ7BR18RKQJaDLGlNut3a4WkdZE+ymllMqsnA4+LlvMdYpI1AYFYk2rvQh4ARiRlsQppZRKWs4GHzvwuOlbtJz4zaibgXJjzDQp4Hl9lFIqHzjqZJpP7KC1EmsKiNaI5auBmXZxXKz915WVlR0ePgeLUkqpxFpaWu4RkZucbFuIwacWeAAr+HSFLZ8GLAMmiEh7nP0/AQYBr2Q6rf1EKIq3eZqKwqHnM330XKZXDdAtImOdbJyzxW7JEpFWY8ySKKvmAo3xAo9tpX2cQLrT1h+F+k/p+UwPPZ/po+cyvcL6SjpScMEHQEQajTGzjDETODiw6FInA4sqpZTKvIIMPgAaaJRSKncVXJ2PUkqp3NcvhtdRSimVWzT4KKWUyrqCrfNRqpDYXQimAO1ANdCunaWTZ4/7WI3VGKkaWBSv/59yzhhTDiwQkdnxttPgo1SOC432ISLTw5YtNca0O+g6oCLYgac9FGzsm+VKY0yFNlRKiwVARaKNtNjNJXuQ0pjzAqnEjDEzjDFzjDGLjDHL7JuBii3azLyLcDf8lDqoOnz0E7sz+gLizPelnLEflBIGHtCcTzIcRXUVnT51JiXaRIgrsEbsUC7Y19slxpjFEQMRN9vrqzU3mZLQSDLRZpLuRXM+LriJ6iomfep0wb5ZVgOd4ctDN06XI7/3e/Z5q7ZfKo3sIcyecrq9Bh93QlFdJSHsqbM8YlXPU2f2U5XzKuBgsIlCz5lLIjIiyrxe04AuzfWkpDzOddqHBh+H3EZ11Zc+dSYlMlCrzJgN3OV1IvKVMWaG29aCWufjXLk9KZ3X6chrIhJtMj996lSeMcbMwpqMMt58YCoGuyTDcY4nRHM+DiQT1ZUr+tSZQJSiSpUGdlHv7PBm7Mq1i5Ppc6bBJ4Fko7pyRp86EwrlBns1dAkLRppbTM0C4EyvE5Gv7M7PK5LZt98Uu7mszO4Mqzi7WJsA95XC+Yw8xmwROTF9KSssdlFvO33rfirQosqU2P315rqpJFd9TAEmGGMuCVtWC1QbYxYAy2OVGvWL4BPqIe5il+VAYypRvZAlez6jLNenTmeasX7k4S20au3lKgl2jntBePC2GxXpqBEuRHswN8bMAU4Skbnx9tUpFeKwL9AJEYtrsVprNREnqqv47KfOBfpDT8wuYlsaMbzOMqxco54/l+yOzhX0frCsAGYmGo9MJWbneKpFZGbc7TT4uBMW1eOeWBWbHdSb9anTOTsXfglWLrIaaNWBRd2zA/nWGKvbRSTyYVM5ZJeIzAUuxiomXow1YGtknyprew0+7jiN6io6fepUSoEGH8fcRnXVlz51KqVCNPgopZTKOu3no5RSKus0+CillMo6DT5KKaWyToOPUkqprNPgo5RSKus0+CillMo6DT5KKaWyToOPUkqprPv/f0jTm4jnAUwAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<matplotlib.figure.Figure at 0x7f6fb758d2d0>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create the samples\n",
    "size=5e3\n",
    "\n",
    "sample = norm.rvs(size=int(size))\n",
    "\n",
    "values, edges, ex, ey = hep_spt.errorbar_hist(sample, 40, rg=(-4, 4))\n",
    "centers = (edges[1:] + edges[:-1])/2.\n",
    "\n",
    "# Extract the PDF values in each center, and make the pull\n",
    "ref  = norm.pdf(centers)\n",
    "ref *= size/ref.sum()\n",
    "\n",
    "pull, perr = hep_spt.pull(values, ey, ref)\n",
    "\n",
    "# Make the reference to plot (with more points than just the centers of the bins)\n",
    "rct, step = np.linspace(-4., 4., 1000, retstep=True)\n",
    "pref = norm.pdf(rct)\n",
    "pref = size*pref/pref.sum()*(edges[1] - edges[0])/step\n",
    "\n",
    "fig, (ax0, ax1) = plt.subplots(2, 1, sharex=True, gridspec_kw = {'height_ratios':[3, 1]})\n",
    "\n",
    "# Draw the histogram and the reference\n",
    "ax0.errorbar(centers, values, ey, ex, color='k', ls='none', label='data')\n",
    "ax0.plot(rct, pref, color='blue', marker='', label='reference')\n",
    "ax0.set_xlim(-4., 4.)\n",
    "ax0.set_ylabel('Entries')\n",
    "ax0.legend()\n",
    "\n",
    "# Draw the pull and lines for -3, 0 and +3 standard deviations\n",
    "add_pull_line = lambda v, c: ax1.plot([-4., 4.], [v, v], color=c, marker='')\n",
    "\n",
    "add_pull_line(0, 'blue')\n",
    "add_pull_line(-3, 'red')\n",
    "add_pull_line(+3, 'red')\n",
    "\n",
    "ax1.errorbar(centers, pull, perr, ex, color='k', ls='none')\n",
    "ax1.set_ylim(-4, 4)\n",
    "ax1.set_yticks([-3, 0, 3])\n",
    "ax1.set_ylabel('Pull');"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Plotting efficiencies"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's suppose we build two histograms from the same sample, one of them after having applied some  requirements. The first histogram will follow a gaussian distribution with center at 0 and standard deviation equal to 2, with 1000 entries. The second, with only 100 entries, will have the same center but the standard deviation will be 0.5. The efficiency plot would be calculated as follows:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<matplotlib.figure.Figure at 0x7f6f8131e1d0>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Create a random sample\n",
    "raw = np.random.normal(0, 2, 1000)\n",
    "cut = np.random.normal(0, 0.5, 100)\n",
    "\n",
    "# Create the histograms (we do not care about the errors for the moment). Note that the two\n",
    "# histograms have the same number of bins and range.\n",
    "h_raw, edges = np.histogram(raw, bins=10, range=(-2, 2))\n",
    "h_cut, _     = np.histogram(cut, bins=10, range=(-2, 2))\n",
    "centers = (edges[1:] + edges[:-1])/2.\n",
    "\n",
    "ex = (edges[1:] - edges[:-1])/2.\n",
    "\n",
    "# Calculate the efficiency and the errors\n",
    "eff = h_cut.astype(float)/h_raw\n",
    "ey  = hep_spt.cp_fu(h_cut, h_raw)\n",
    "\n",
    "plt.errorbar(centers, eff, ey, ex, ls='none');"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 2",
   "language": "python",
   "name": "python2"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 2
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython2",
   "version": "2.7.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
