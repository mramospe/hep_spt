
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>einsum_path &#8212; hep_spt 0.0.0.dev4 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="bmat" href="numpy.bmat.html" />
    <link rel="prev" title="einsum" href="numpy.einsum.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="einsum-path">
<h1>einsum_path<a class="headerlink" href="#einsum-path" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="numpy.einsum_path">
<code class="sig-prename descclassname">numpy.</code><code class="sig-name descname">einsum_path</code><span class="sig-paren">(</span><em class="sig-param">subscripts</em>, <em class="sig-param">*operands</em>, <em class="sig-param">optimize='greedy'</em><span class="sig-paren">)</span><a class="headerlink" href="#numpy.einsum_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the lowest cost contraction order for an einsum expression by
considering the creation of intermediate arrays.</p>
<dl>
<dt>subscripts<span class="classifier">str</span></dt><dd><p>Specifies the subscripts for summation.</p>
</dd>
<dt><a href="#id1"><span class="problematic" id="id2">*</span></a>operands<span class="classifier">list of array_like</span></dt><dd><p>These are the arrays for the operation.</p>
</dd>
<dt>optimize<span class="classifier">{bool, list, tuple, ‘greedy’, ‘optimal’}</span></dt><dd><p>Choose the type of path. If a tuple is provided, the second argument is
assumed to be the maximum intermediate size created. If only a single
argument is provided the largest input or output array size is used
as a maximum intermediate size.</p>
<ul class="simple">
<li><p>if a list is given that starts with <code class="docutils literal notranslate"><span class="pre">einsum_path</span></code>, uses this as the
contraction path</p></li>
<li><p>if False no optimization is taken</p></li>
<li><p>if True defaults to the ‘greedy’ algorithm</p></li>
<li><p>‘optimal’ An algorithm that combinatorially explores all possible
ways of contracting the listed tensors and choosest the least costly
path. Scales exponentially with the number of terms in the
contraction.</p></li>
<li><p>‘greedy’ An algorithm that chooses the best pair contraction
at each step. Effectively, this algorithm searches the largest inner,
Hadamard, and then outer products at each step. Scales cubically with
the number of terms in the contraction. Equivalent to the ‘optimal’
path for most contractions.</p></li>
</ul>
<p>Default is ‘greedy’.</p>
</dd>
</dl>
<dl class="simple">
<dt>path<span class="classifier">list of tuples</span></dt><dd><p>A list representation of the einsum path.</p>
</dd>
<dt>string_repr<span class="classifier">str</span></dt><dd><p>A printable representation of the einsum path.</p>
</dd>
</dl>
<p>The resulting path indicates which terms of the input contraction should be
contracted first, the result of this contraction is then appended to the
end of the contraction list. This list can then be iterated over until all
intermediate contractions are complete.</p>
<p>einsum, linalg.multi_dot</p>
<p>We can begin with a chain dot example. In this case, it is optimal to
contract the <code class="docutils literal notranslate"><span class="pre">b</span></code> and <code class="docutils literal notranslate"><span class="pre">c</span></code> tensors first as represented by the first
element of the path <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">2)</span></code>. The resulting tensor is added to the end
of the contraction and the remaining contraction <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">1)</span></code> is then
completed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_info</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum_path</span><span class="p">(</span><span class="s1">&#39;ij,jk,kl-&gt;il&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="s1">&#39;greedy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">path_info</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[&#39;einsum_path&#39;, (1, 2), (0, 1)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">path_info</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">  Complete contraction:  ij,jk,kl-&gt;il # may vary</span>
<span class="go">         Naive scaling:  4</span>
<span class="go">     Optimized scaling:  3</span>
<span class="go">      Naive FLOP count:  1.600e+02</span>
<span class="go">  Optimized FLOP count:  5.600e+01</span>
<span class="go">   Theoretical speedup:  2.857</span>
<span class="go">  Largest intermediate:  4.000e+00 elements</span>
<span class="go">-------------------------------------------------------------------------</span>
<span class="go">scaling                  current                                remaining</span>
<span class="go">-------------------------------------------------------------------------</span>
<span class="go">   3                   kl,jk-&gt;jl                                ij,jl-&gt;il</span>
<span class="go">   3                   jl,ij-&gt;il                                   il-&gt;il</span>
</pre></div>
</div>
<p>A more complex index transformation example.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_info</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum_path</span><span class="p">(</span><span class="s1">&#39;ea,fb,abcd,gc,hd-&gt;efgh&#39;</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">optimize</span><span class="o">=</span><span class="s1">&#39;greedy&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">path_info</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[&#39;einsum_path&#39;, (0, 2), (0, 3), (0, 2), (0, 1)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">path_info</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> 
<span class="go">  Complete contraction:  ea,fb,abcd,gc,hd-&gt;efgh # may vary</span>
<span class="go">         Naive scaling:  8</span>
<span class="go">     Optimized scaling:  5</span>
<span class="go">      Naive FLOP count:  8.000e+08</span>
<span class="go">  Optimized FLOP count:  8.000e+05</span>
<span class="go">   Theoretical speedup:  1000.000</span>
<span class="go">  Largest intermediate:  1.000e+04 elements</span>
<span class="go">--------------------------------------------------------------------------</span>
<span class="go">scaling                  current                                remaining</span>
<span class="go">--------------------------------------------------------------------------</span>
<span class="go">   5               abcd,ea-&gt;bcde                      fb,gc,hd,bcde-&gt;efgh</span>
<span class="go">   5               bcde,fb-&gt;cdef                         gc,hd,cdef-&gt;efgh</span>
<span class="go">   5               cdef,gc-&gt;defg                            hd,defg-&gt;efgh</span>
<span class="go">   5               defg,hd-&gt;efgh                               efgh-&gt;efgh</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">hep_spt</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../main.html">Functions and classes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../main.html#numpy">NumPy</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../main.html#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../main.html#classes">Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../main.html#class-inheritance-diagram">Class Inheritance Diagram</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../main.html">Functions and classes</a><ul>
      <li>Previous: <a href="numpy.einsum.html" title="previous chapter">einsum</a></li>
      <li>Next: <a href="numpy.bmat.html" title="next chapter">bmat</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Miguel Ramos Pernas.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/api/numpy.einsum_path.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>